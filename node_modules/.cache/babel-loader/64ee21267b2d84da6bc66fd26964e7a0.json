{"ast":null,"code":"var _jsxFileName = \"/Users/hsalmon/Dev/rogue_templates/RS-tactical_kinetics/src/components/CollectionConstructor.jsx\";\n\n/*\n=====================================================\nOMEGA19 Object\nCollection Constructor\n=====================================================\n*/\nimport React from 'react';\nimport ProductItem from './ProductItem';\nimport ProductImage1 from '../static/img/no-image.png';\nimport LoadingFiller from './LoadingFiller';\nimport Warning from './Warning';\nexport default class CollectionConstructor extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      rawData: {},\n      isProductsLoaded: false,\n      isProductImagesLoaded: false,\n      isCategoriesLoaded: false,\n      isError: false,\n      title: \"\",\n      id: this.props.id ? this.props.id : -1,\n      rawProducts: [],\n      rawCategories: []\n    };\n    this.componentDidMount = this.componentDidMount.bind(this);\n  }\n\n  renderLoading() {\n    if (!this.state.isProductsLoaded) {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 34\n        },\n        __self: this\n      }, React.createElement(LoadingFiller, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 35\n        },\n        __self: this\n      }));\n    }\n  }\n\n  productStripper(items) {\n    var stringSanitizer = require(\"string-sanitizer\");\n\n    let data = [];\n    let products = items;\n\n    for (var i = 0; i < products.length; i++) {\n      const indexItem = products[i];\n      let item = {\n        id: indexItem.id,\n        title: indexItem.name,\n        price: indexItem.price,\n        slug: stringSanitizer.sanitize.addDash(indexItem.id + \" \" + indexItem.name),\n        image: \"\"\n      };\n\n      if (indexItem.images.length > 0) {\n        item.image = indexItem.images[0].url_standard;\n      }\n\n      data.push(item);\n    }\n\n    return data;\n  }\n\n  componentDidMount() {\n    if (this.props.id == \"all\") {\n      global.API.getProducts().then(success => {\n        let items = this.productStripper(success.data.data);\n        this.setState({\n          rawProducts: success.data.data,\n          products: items,\n          title: \"All Products\",\n          isProductsLoaded: true\n        });\n      }, error => {});\n    } else {\n      // gets products\n      global.API.getProducts().then(success => {\n        var preItems = [];\n        var id = this.state.id;\n        preItems = success.data.data;\n        var postItems = preItems.filter(function (a) {\n          if (a.categories.length > 0) {\n            var found = a.categories.includes(id);\n\n            if (found) {\n              return true;\n            } else {\n              return false;\n            }\n          } else {\n            return false;\n          }\n        });\n        let items = this.productStripper(postItems);\n        this.setState({\n          rawProducts: success.data.data,\n          products: items,\n          title: this.props.title,\n          isProductsLoaded: true\n        });\n      }, error => {});\n    }\n  }\n\n  shouldComponentUpdate() {\n    return true;\n  }\n\n  renderProducts() {\n    var stringSanitizer = require(\"string-sanitizer\");\n\n    let products = [];\n    let DOMitems = [];\n\n    if (this.state.isProductsLoaded == true) {\n      let products = this.state.products;\n\n      for (var i = 0; i < products.length; i++) {\n        const title = products[i].title;\n        const price = products[i].price;\n        const image = products[i].image;\n        const slug = products[i].slug;\n        const id = products[i].id;\n        DOMitems.push(React.createElement(ProductItem, {\n          collection: true,\n          key: id,\n          title: title,\n          price: price,\n          image: image,\n          link: \"/product/\" + slug,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }));\n      }\n\n      if (DOMitems.length == 0) {\n        DOMitems.push(React.createElement(Warning, {\n          message: \"No items are available in this collection.\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135\n          },\n          __self: this\n        }));\n      }\n    }\n\n    return DOMitems;\n  }\n\n  filterChanged(e) {\n    const value = e.target.value;\n\n    if (this.state.isProductsLoaded) {\n      let products = this.state.products;\n\n      if (value == \"price-low-to-high\") {\n        products.sort(function (a, b) {\n          return a.price > b.price ? 1 : -1;\n        });\n      } else if (value == \"price-high-to-low\") {\n        products.sort(function (a, b) {\n          return a.price < b.price ? 1 : -1;\n        });\n      } else if (value == \"a-z\") {\n        products.sort(function (a, b) {\n          let nameA = String(a.title).toLowerCase().trim();\n          let nameB = String(b.title).toLowerCase().trim();\n          return nameA > nameB ? 1 : -1;\n        });\n      } else if (value == \"z-a\") {\n        products.sort(function (a, b) {\n          let nameA = String(a.title).toLowerCase().trim();\n          let nameB = String(b.title).toLowerCase().trim();\n          return nameA < nameB ? 1 : -1;\n        });\n      }\n\n      this.setState({\n        products: products\n      });\n    }\n  }\n\n  renderMainComponents() {\n    if (!this.state.isProductsLoaded) {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, React.createElement(LoadingFiller, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }));\n    } else {\n      return React.createElement(\"div\", {\n        className: \"product-item-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, this.renderLoading(), this.renderProducts());\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"CollectionConstructor collection page\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"desktop-fifth mobile-whole left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, this.state.title), React.createElement(\"label\", {\n      htmlFor: \"collection-filter\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, \"Sort By\"), React.createElement(\"select\", {\n      id: \"collection-filter\",\n      onChange: e => this.filterChanged(e),\n      className: \"collection-filter-select\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, \"Select...\"), React.createElement(\"option\", {\n      value: \"a-z\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, \"A-Z\"), React.createElement(\"option\", {\n      value: \"z-a\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, \"Z-A\"), React.createElement(\"option\", {\n      value: \"price-low-to-high\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, \"Price: Low to High\"), React.createElement(\"option\", {\n      value: \"price-high-to-low\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, \"Price: High to Low\"))), React.createElement(\"div\", {\n      className: \"desktop-four-fifths mobile-whole right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, this.renderMainComponents()), React.createElement(\"div\", {\n      className: \"clearfix\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }));\n  }\n\n}","map":{"version":3,"sources":["/Users/hsalmon/Dev/rogue_templates/RS-tactical_kinetics/src/components/CollectionConstructor.jsx"],"names":["React","ProductItem","ProductImage1","LoadingFiller","Warning","CollectionConstructor","Component","constructor","props","state","rawData","isProductsLoaded","isProductImagesLoaded","isCategoriesLoaded","isError","title","id","rawProducts","rawCategories","componentDidMount","bind","renderLoading","productStripper","items","stringSanitizer","require","data","products","i","length","indexItem","item","name","price","slug","sanitize","addDash","image","images","url_standard","push","global","API","getProducts","then","success","setState","error","preItems","postItems","filter","a","categories","found","includes","shouldComponentUpdate","renderProducts","DOMitems","filterChanged","e","value","target","sort","b","nameA","String","toLowerCase","trim","nameB","renderMainComponents","render"],"mappings":"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","sourcesContent":["/*\n=====================================================\nOMEGA19 Object\nCollection Constructor\n=====================================================\n*/\n\nimport React from 'react';\nimport ProductItem from './ProductItem';\nimport ProductImage1 from '../static/img/no-image.png';\nimport LoadingFiller from './LoadingFiller';\nimport Warning from './Warning';\n\nexport default class CollectionConstructor extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            rawData: {},\n            isProductsLoaded: false,\n            isProductImagesLoaded: false,\n            isCategoriesLoaded: false,\n            isError: false,\n            title: \"\",\n            id: this.props.id ? this.props.id : -1,\n            rawProducts: [],\n            rawCategories: [],\n        }\n        this.componentDidMount = this.componentDidMount.bind(this);\n    }\n\n    renderLoading() {\n        if (!this.state.isProductsLoaded) {\n            return (\n                <div>\n                    <LoadingFiller />\n                </div>\n            );\n        }\n    }\n\n    productStripper(items) {\n        var stringSanitizer = require(\"string-sanitizer\");\n        let data = [];\n        let products = items;\n\n        for (var i = 0; i < products.length; i++) {\n            const indexItem = products[i];\n            let item = {\n                id: indexItem.id,\n                title: indexItem.name,\n                price: indexItem.price,\n                slug: stringSanitizer.sanitize.addDash(indexItem.id + \" \" + indexItem.name),\n                image: \"\"\n            }\n            if (indexItem.images.length > 0) {\n                item.image = indexItem.images[0].url_standard;\n            }\n            data.push(item);\n        }\n        return data;\n    }\n\n    componentDidMount() {\n        if (this.props.id == \"all\") {\n            global.API.getProducts().then(\n                (success) => {\n                    let items = this.productStripper(success.data.data);\n                    this.setState({\n                        rawProducts: success.data.data,\n                        products: items,\n                        title: \"All Products\",\n                        isProductsLoaded: true\n                    });\n                },\n                (error) => { }\n            );\n        } else {\n            // gets products\n            global.API.getProducts().then(\n                (success) => {\n                    var preItems = [];\n                    var id = this.state.id;\n                    preItems = success.data.data;\n\n                    var postItems = preItems.filter(function (a) {\n                        if (a.categories.length > 0) {\n                            var found = a.categories.includes(id);\n                            if (found) {\n                                return true;\n                            } else {\n                                return false;\n                            }\n                        } else {\n                            return false;\n                        }\n                    });\n                    let items = this.productStripper(postItems);\n                    this.setState({\n                        rawProducts: success.data.data,\n                        products: items,\n                        title: this.props.title,\n                        isProductsLoaded: true\n                    });\n                },\n                (error) => { }\n            );\n        }\n    }\n\n    shouldComponentUpdate() {\n        return true;\n    }\n\n    renderProducts() {\n        var stringSanitizer = require(\"string-sanitizer\");\n\n        let products = [];\n        let DOMitems = [];\n\n        if (this.state.isProductsLoaded == true) {\n            let products = this.state.products;\n            for (var i = 0; i < products.length; i++) {\n                const title = products[i].title;\n                const price = products[i].price;\n                const image = products[i].image;\n                const slug = products[i].slug;\n                const id = products[i].id;\n\n                DOMitems.push(\n                    <ProductItem collection key={id} title={title} price={price} image={image} link={\"/product/\" + slug} />\n                );\n            }\n            if (DOMitems.length == 0) {\n                DOMitems.push(\n                    <Warning message=\"No items are available in this collection.\" />\n                );\n            }\n        }\n        return DOMitems;\n    }\n\n    filterChanged(e) {\n        const value = e.target.value;\n        if (this.state.isProductsLoaded) {\n            let products = this.state.products;\n\n            if (value == \"price-low-to-high\") {\n                products.sort(\n                    function (a, b) {\n                        return a.price > b.price ? 1 : -1;\n                    }\n                );\n            } else if (value == \"price-high-to-low\") {\n                products.sort(\n                    function (a, b) {\n                        return a.price < b.price ? 1 : -1;\n                    }\n                );\n            } else if (value == \"a-z\") {\n                products.sort(\n                    function (a, b) {\n                        let nameA = String(a.title).toLowerCase().trim();\n                        let nameB = String(b.title).toLowerCase().trim();\n                        return nameA > nameB ? 1 : -1;\n                    }\n                );\n            } else if (value == \"z-a\") {\n                products.sort(\n                    function (a, b) {\n                        let nameA = String(a.title).toLowerCase().trim();\n                        let nameB = String(b.title).toLowerCase().trim();\n                        return nameA < nameB ? 1 : -1;\n                    }\n                );\n            }\n\n            this.setState({\n                products: products\n            });\n        }\n    }\n    renderMainComponents() {\n        if(!this.state.isProductsLoaded)  {\n            return (\n                <div>\n                    <LoadingFiller/>\n                </div>\n            );\n        } else {\n            return (\n                <div className=\"product-item-container\">\n                    {this.renderLoading()}\n                    {this.renderProducts()}\n                </div>\n            );\n        }\n    }\n    render() {\n        return (\n            <div className=\"CollectionConstructor collection page\">\n                <div className=\"desktop-fifth mobile-whole left\">\n                    <h1>{this.state.title}</h1>\n                    <label htmlFor=\"collection-filter\">Sort By</label>\n                    <select id=\"collection-filter\" onChange={(e) => this.filterChanged(e)} className=\"collection-filter-select\">\n                        {/* <option value=\"best-selling\">Best selling</option> */}\n                        {/* <option value=\"best-rating\">Best rating</option> */}\n                        <option value=\"\">Select...</option>\n                        <option value=\"a-z\">A-Z</option>\n                        <option value=\"z-a\">Z-A</option>\n                        <option value=\"price-low-to-high\">Price: Low to High</option>\n                        <option value=\"price-high-to-low\">Price: High to Low</option>\n                        {/* <option value=\"date-newest-first\">Date: Newest first</option> */}\n                        {/* <option value=\"date-oldest-first\">Date: Oldest first</option> */}\n                    </select>\n                </div>\n                <div className=\"desktop-four-fifths mobile-whole right\">\n                    {this.renderMainComponents()}\n                </div>\n                <div className=\"clearfix\"></div>\n            </div>\n        );\n    }\n}"]},"metadata":{},"sourceType":"module"}